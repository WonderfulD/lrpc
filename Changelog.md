# 更新日志

自`2025年2月17日（星期一）11:00:00 (UTC+8)`起，所有版本更改都记录在此文件中

---

## [未发布]

### 新增
- 高并发
- 高可用
- 重试机制
- 使用ZooKeeper管理节点
- 全局异常处理器

### 变更
- 优化负载均衡策略
- 本地和远程注册中心皆未找到服务时仍会尝试构建负载均衡器
- 服务实例下线时若该服务已无实例，Redis中Entry不会被删除

### 修复
- 同一provider多次重复启动（远程注册中心记录未过期时），可能导致意外的问题
- rpc-provider下线时只会下线最后一个注册的serviceImpl
- 高并发下，若服务实例已过期，lua脚本仍会给该服务实例续期（应当无影响）

### 其他
- 无

---

## [0.7.0] - 2025-03-05

### 新增
- 过期服务删除机制
- 线程池工厂
- 服务实例注册时额外判断是否之前已被注册
- 服务实例新增uuid字段，唯一标识某个对象，需要创建相同实例对象时应当重新生成

### 变更
- 修改了rpc-provider是否启动的标志位状态变更的执行时机
- 修改了服务续期机制的执行循环逻辑，不依靠任务自行管理，使用线程池管理
- 服务实例续期时使用乐观锁：先判断要续期的服务实例的uuid是否还存在，只有还存在才续期（lua脚本）
- Redisson编解码器变更为`StringCodec.INSTANCE`

### 修复
- 修复了服务实例续期时续期时间单位错误的问题
- 远程注册中心下线服务实例失败的问题
- 远程注册中心过滤服务实例列表的方式

### 其他
- 服务实例续期任务和过期服务实例下线任务并行执行
- rpc-provider使用单线程线程池，只启动一次
- 优化了日志

---

## [0.6.0] - 2025-03-04

### 新增
- 服务续期机制，每1/2U生存时间续期1U生存时间
- provider启动时开启新线程进行服务续期【心跳机制】
- provider关闭时会下线自己实例

### 变更
- 无

### 修复
- 无

### 其他
- 无

---

## [0.5.0] - 2025-02-25

### 新增
- 新增provider和consumer的application.yml文件及其模版
- 新增RpcConsumerLoader类，使用Spring Factories来加载具体RpcConsumer实现
- 新增RpcService后置处理器，用于启动provider
- 丰富了RpcService注解内容，现在可以传入指定实现接口、服务版本、服务有效期

### 变更
- SpringBoot兼容性：provider现在使用SpringBoot启动
- consumer现在使用Spring Factories来加载具体RpcConsumer实现，而非Java SPI
- rpc-framework中部分组件现在被Spring管理
- 删除了原Java SPI需要的配置文件

### 修复
- 无

### 其他
- 无

---

## [0.4.2] - 2025-02-21

### 新增
- 新增servicemanager包，管理服务续期、心跳、可用性等

### 变更
- 修改了consumer、provider运行端口

### 修复
- 无

### 其他
- 无

---

## [0.4.1] - 2025-02-20

### 新增
- Consumer新增Netty网络通信实现
- Consumer启动时可以通过spi机制选择具体网络通信实现

### 变更
- 无

### 修复
- 无

### 其他
- 无

---

## [0.4.0] - 2025-02-20

### 新增
- provider新增Netty网络通信实现
- provider启动时可以通过spi机制选择具体网络通信实现
- rpc-core模块新增了serviceselect包，抽象出原SimpleHttpClient类的选择服务的逻辑，为日后负载均衡、重试、容错等机制的介入做准备

### 变更
- 修改了Consumer动态代理发送rpc请求时传入的参数
- 优化了日志

### 修复
- 无

### 其他
- 无

---

## [0.3.0] - 2025-02-19

### 新增
- 新增一致性哈希负载均衡器
- 增加了@RpcReference注解的字段，包含更丰富的内容
- 优化了日志
- 可以通过@RpcReference注解使用指定方式调用对应的方法

### 变更
- 修改了RpcResponseDO的内容，可以包含更多信息
- 根据RpcResponseDO的状态码来解析rpc响应

### 修复
- 无

### 其他
- 无

---

## [0.2.0] - 2025-02-18

### 新增
- 增加`SpringBoot`依赖
- 使用`SpringFramework`的初始化Bean后置处理器为Consumer中的TestController注入Bean

### 变更
- 修改Consumer的实现方式为SpringBoot应用

### 修复
- 无

### 其他
- 无

---

## [0.1.0] - 2025-02-17

### 新增
- 初始发布版本，包含以下功能：
    - 省略，参考`README.md`文件

### 变更
- 无

### 修复
- 无

### 其他
- 无
